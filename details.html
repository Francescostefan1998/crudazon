<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>product</title>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css"
      integrity="sha384-xOolHFLEh07PJGoPkLv1IbcEPTNtaed2xpHsD9ESMhqIYd0nLMwNLD69Npy4HI+N"
      crossorigin="anonymous"
    />
  </head>
  <body>
    <div id="main"></div>
    <button type="button" class="btn btn-success" onclick="edit()">
      Edit Product
    </button>
    <button type="button" class="btn btn-danger" onclick="Delete()">
      Delete Product
    </button>
    <script>
      const param = new URLSearchParams(window.location.search);
      console.log(param);
      const productId = param.get("productId");

      async function getProducts() {
        const response = await fetch(
          `https://striveschool-api.herokuapp.com/api/product/${productId}`,
          {
            headers: {
              Authorization:
                "Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJfaWQiOiI2MDgxN2M1ZWU3ODE4NzAwMTVjMjY3YTgiLCJpYXQiOjE2NjgwODY1NzQsImV4cCI6MTY2OTI5NjE3NH0.De_M73adDP7xkHGf7dPGT2OuIzJWSZIBPPuczezr6Ms",
            },
          }
        );
        const products = await response.json();
        console.log(products);
        return products;
      }

      function renderProducts(listOfproducts) {
        let total = document.querySelector("#main");
        console.log(total);
        total.innerHTML = `<div class="card row px-3 align-items-center">
        <img src="${listOfproducts.imageUrl}" class="card-img-top" alt="...">
        <div class="card-body">
          <h5 class="card-title">1 - ${listOfproducts.name}</h5>
          <p class="card-text">Description of the product: ${listOfproducts.description}</p>
        </div>
        <ul class="list-group list-group-flush">
          <li class="list-group-item">Price: ${listOfproducts.price}â‚¬</li>
          <li class="list-group-item">Order: ${listOfproducts._id}</li>
          <li class="list-group-item">A third item</li>
        </ul>
        <div class="card-body row justify-content-between">
          <a class"col" href="details.html?productId=${listOfproducts._id}">VIEW DETAILS</a>
        </div>
      </div>`;
      }

      window.onload = async () => {
        const products = await getProducts();
        renderProducts(products);
      };

      function edit() {
        window.location.assign(`createproduct.html?productId=${productId}`);
      }
    </script>
    <script
      src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.slim.min.js"
      integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-Fy6S3B9q64WdZWQUiU+q4/2Lc9npb8tCaSX9FK7E8HnRr0Jz8D6OP9dO5Vg3Q9ct"
      crossorigin="anonymous"
    ></script>
  </body>
</html>
